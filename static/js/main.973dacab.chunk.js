(this["webpackJsonpapollo-music-share"]=this["webpackJsonpapollo-music-share"]||[]).push([[0],{138:function(e,t,a){e.exports=a(176)},176:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),l=a(17),i=a.n(l),c=a(22),o=a(208),u=(a(211),a(212),a(130)),s=(a(123),Object(o.a)((function(e){return{title:{marginLeft:e.spacing(2)}}})));var m=function(){s()},d=a(213),p=a(242),g=a(214),b=a(215);var h=Object(o.a)({avatar:{width:44,height:44},text:{textOverflow:"ellipsis",overflow:"hidden"},container:{display:"grid",gridAutoFlow:"column",gridTemplateColumns:"50px auto 50px",gridGap:12,alignItems:"center",marginTop:10},songInfoContainer:{overflow:"hidden",whiteSpace:"nowrap"}});function f(e){var t=e.song,a=t.title,n=t.artist,l=t.thumbnail,i=h();return r.a.createElement("div",{className:i.container},r.a.createElement(p.a,{src:l,className:i.avatar}),r.a.createElement("div",{className:i.songInfoContainer},r.a.createElement(u.a,{className:i.text,variant:"subtitle2"},a),r.a.createElement(u.a,{className:i.text,color:"textSecondary",variant:"body2"},n)),r.a.createElement(g.a,null,r.a.createElement(b.a,{color:"error"})))}var E=function(){var e=Object(d.a)((function(e){return e.breakpoints.up("md")})),t={title:"LUNE",artist:"MOON",thumbnail:"https://picsum.photos/id/237/100/100"};return e&&r.a.createElement("div",{style:{margin:"10px 0"}},r.a.createElement(u.a,{color:"textSecondary",variant:"button"},"QUEUE (5)"),Array.from({length:5},(function(){return t})).map((function(e,t){return r.a.createElement(f,{key:t,song:e})})))},v=a(216),y=a(217),O=a(243),x=a(222),j=a(218),S=a(219),N=a(220),w=a(221),C=Object(o.a)((function(e){return{container:{display:"flex",justifyContent:"space-between"},details:{display:"flex",flexDirection:"column",padding:"0px 15px"},content:{flex:"1 0 auto"},thumbnail:{width:150},controls:{display:"flex",alignItems:"center",paddingLeft:e.spacing(1),paddingRight:e.spacing(1)},playIcon:{height:38,width:38}}}));var k=function(){var e=Object(n.useContext)(pe),t=e.state,a=e.dispatch,l=C();return r.a.createElement(r.a.Fragment,null,r.a.createElement(v.a,{variant:"outlined",className:l.container},r.a.createElement("div",{className:l.details},r.a.createElement(y.a,{className:l.content},r.a.createElement(u.a,{variant:"h5",component:"h3"},t.song.title),r.a.createElement(u.a,{variant:"subtitle1",component:"p",color:"textSecondary"},t.song.title)),r.a.createElement("div",{className:l.controls},r.a.createElement(g.a,null,r.a.createElement(j.a,null)),r.a.createElement(g.a,{onClick:function(){a(t.isPlaying?{type:"PAUSE_SONG"}:{type:"PLAY_SONG"})}},t.isPlaying?r.a.createElement(S.a,{className:l.playIcon}):r.a.createElement(N.a,{className:l.playIcon})),r.a.createElement(g.a,null,r.a.createElement(w.a,null)),r.a.createElement(u.a,{variant:"subtitle1",component:"p",color:"textSecondary"},"00:01:30")),r.a.createElement(O.a,{type:"range",min:0,max:1,step:.01})),r.a.createElement(x.a,{className:l.thumbnail,image:t.song.thumbnail})),r.a.createElement(E,null))},I=a(223),P=a(224),A=a(225),_=a(32),T=a(79);function L(){var e=Object(T.a)(["\nsubscription getSongs {\n    songs(order_by: {created_at: desc}){\n        artist\n        duration\n        id\n        thumbnail\n        title\n        url\n    }\n  }\n"]);return L=function(){return e},e}var $=Object(_.gql)(L());var G=Object(o.a)((function(e){return{container:{margin:e.spacing()},songInfoContainer:{display:"flex",alignItems:"center"},songInfo:{width:"100%",display:"flex",justifyContent:"space-between"},thumbnail:{objectFit:"cover",width:140,height:140}}}));function F(e){var t=e.song,a=t.title,l=t.artist,i=t.thumbnail,o=t.id,s=Object(n.useState)(!1),m=Object(c.a)(s,2),d=m[0],p=m[1],b=Object(n.useContext)(pe),h=b.state,f=b.dispatch;console.log(t),Object(n.useEffect)((function(){var e=h.isPlaying&&o===h.song.id;p(e)}),[o,h.isPlaying,h.song.id]);var E=G();return r.a.createElement(v.a,{className:E.container},r.a.createElement("div",{className:E.songInfoContainer},r.a.createElement(x.a,{className:E.thumbnail,image:i}),r.a.createElement("div",{className:E.songInfo},r.a.createElement(y.a,null,r.a.createElement(u.a,{gutterBottom:!0,variant:"h5",component:"h2"},a),r.a.createElement(u.a,{variant:"body1",component:"p",color:"textSecondary"},l)),r.a.createElement(P.a,null,r.a.createElement(g.a,{onClick:function(){f({type:"SET_SONG",payload:{song:t}}),f(h.isPlaying?{type:"PAUSE_SONG"}:{type:"PLAY_SONG"})},size:"small",color:"primary"},d?r.a.createElement(S.a,null):r.a.createElement(N.a,null)),r.a.createElement(g.a,{size:"small",color:"secondary"},r.a.createElement(A.a,{color:"secondary"}))))))}var U=function(){var e=Object(_.useSubscription)($),t=e.data,a=e.loading,n=e.error;return a?r.a.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",marginTop:50}},r.a.createElement(I.a,null)):n?r.a.createElement("div",null,"Error fetching songs"):r.a.createElement("div",null,t.songs.map((function(e){return r.a.createElement(F,{key:e.id,song:e})})))},D=a(63),M=a.n(D),B=a(18),W=a(36),Y=a(92),q=a(241),R=a(226),z=a(227),J=a(238),Q=a(228),V=a(229),Z=a(230),H=a(231),K=a(232),X=a(90),ee=a.n(X),te=a(91),ae=a.n(te),ne=a(125),re=a.n(ne);function le(){var e=Object(T.a)(["\nmutation addSong($title: String!, $artist: String!, $thumbnail: String!, $duration: Float!, $url: String!) {\n    insert_songs(objects: {url: $url, title: $title, thumbnail: $thumbnail, duration: $duration, artist: $artist}) {\n      affected_rows\n    }\n  }\n"]);return le=function(){return e},e}var ie=Object(_.gql)(le()),ce=Object(o.a)((function(e){return{container:{display:"flex",alignItems:"center"},urLInput:{margin:e.spacing(1)},addSongButton:{margin:e.spacing(1)},dialog:{textAlign:"center"},thumbnail:{width:"90%"}}})),oe={duration:0,title:"",artist:"",thumbnail:""};var ue=function(){var e=Object(n.useState)(""),t=Object(c.a)(e,2),a=t[0],l=t[1],i=Object(_.useMutation)(ie),o=Object(c.a)(i,2),u=o[0],s=o[1].error,m=Object(n.useState)(!1),d=Object(c.a)(m,2),p=d[0],g=d[1],b=ce(),h=Object(n.useState)(!1),f=Object(c.a)(h,2),E=f[0],v=f[1],y=Object(n.useState)(oe),O=Object(c.a)(y,2),x=O[0],j=O[1];function S(){v(!1)}function N(){return(N=Object(Y.a)(M.a.mark((function e(t){var n,r,l;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.player,!(r=n.player.player).getVideoData){e.next=6;break}l=w(r),e.next=10;break;case 6:if(!r.getCurrentSound){e.next=10;break}return e.next=9,C(r);case 9:l=e.sent;case 10:j(Object(W.a)(Object(W.a)({},l),{},{url:a}));case 11:case"end":return e.stop()}}),e)})))).apply(this,arguments)}function w(e){var t=e.getDuration(),a=e.getVideoData(),n=a.title,r=a.video_id;return{duration:t,title:n,artist:a.author,thumbnail:"http://img.youtube.com/vi/".concat(r,"/0.jpg")}}function C(e){return new Promise((function(t){e.getCurrentSound((function(e){e&&t({duration:Number(e.duration/1e3),title:e.title,artist:e.user.username,thumbnail:e.artwork_url.replace("-large","-t500x500")})}))}))}function k(){return(k=Object(Y.a)(M.a.mark((function e(){var t,a,n,r,i;return M.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,t=x.url,a=x.duration,n=x.title,r=x.artist,i=x.thumbnail,e.next=4,u({variables:{url:t.length>0?t:null,title:n.length>0?n:null,artist:r.length>0?r:null,thumbnail:i.length>0?i:null,duration:a>0?a:null}});case 4:S(),j(oe),l(""),e.next=12;break;case 9:e.prev=9,e.t0=e.catch(0),console.error("Error adding song",e.t0);case 12:case"end":return e.stop()}}),e,null,[[0,9]])})))).apply(this,arguments)}function I(e){var t,a;return null===s||void 0===s||null===(t=s.graphQLErrors[0])||void 0===t||null===(a=t.extensions)||void 0===a?void 0:a.path.includes(e)}function P(e){var t=e.target,a=t.name,n=t.value;j((function(e){return Object(W.a)(Object(W.a)({},e),{},Object(B.a)({},a,n))}))}Object(n.useEffect)((function(){var e=ee.a.canPlay(a)||ae.a.canPlay(a);g(e)}),[a]);var A=x.title,T=x.artist,L=x.thumbnail;return r.a.createElement("div",{className:b.container},r.a.createElement(q.a,{className:b.dialog,open:E,onClose:S},r.a.createElement(R.a,null,"Edit Song"),r.a.createElement(z.a,null,r.a.createElement("img",{src:L,alt:"Song thumbnail",className:b.thumbnail}),r.a.createElement(J.a,{onChange:P,margin:"dense",name:"title",label:"Title",value:A,fullWidth:!0,error:I("title"),helperText:I("title")&&"Fill out field"}),r.a.createElement(J.a,{onChange:P,margin:"dense",name:"artist",label:"Artist",value:T,fullWidth:!0,error:I("artist"),helperText:I("artist")&&"Fill out field"}),r.a.createElement(J.a,{onChange:P,margin:"dense",name:"thumbnail",label:"Thumbnail",value:L,fullWidth:!0,error:I("thumbnail"),helperText:I("thumbnail")&&"Fill out field"})),r.a.createElement(Q.a,null,r.a.createElement(V.a,{onClick:S,color:"secondary"},"Cancel"),r.a.createElement(V.a,{variant:"outlined",color:"primary",onClick:function(){return k.apply(this,arguments)}},"Add Song"))),r.a.createElement(J.a,{className:b.urLInput,onChange:function(e){l(e.target.value)},value:a,placeholder:"Add Youtube or Soundcloud url",fullWidth:!0,margin:"normal",type:"url",InputProps:{startAdornment:r.a.createElement(Z.a,{position:"start"},r.a.createElement(H.a,null))}}),r.a.createElement(V.a,{disabled:!p,className:b.addSongButton,onClick:function(e){e.preventDefault(),v(!0)},variant:"contained",color:"primary",endIcon:r.a.createElement(K.a,null)},"Add"),r.a.createElement(re.a,{url:a,hidden:!0,onReady:function(e){return N.apply(this,arguments)}}))},se=a(240),me=a(233);var de=function(e,t){switch(t.type){case"PLAY_SONG":return Object(W.a)(Object(W.a)({},e),{},{isPlaying:!0});case"PAUSE_SONG":return Object(W.a)(Object(W.a)({},e),{},{isPlaying:!1});case"SET_SONG":return Object(W.a)(Object(W.a)({},e),{},{song:t.payload.song});default:return e}},pe=r.a.createContext({song:{id:"3561c605-d486-44cb-9bba-d1beeb641778",title:"LUNE",artist:"MOON",thumbnail:"https://picsum.photos/id/237/100/100",duration:250,url:"https://music.youtube.com/watch?v=--ZtUFsIgMk&feature=share"},isPlaying:!1});pe.displayName="SongContext";var ge=function(){var e=r.a.useContext(pe),t=r.a.useReducer(de,e),a=Object(c.a)(t,2),n=a[0],l=a[1],i=Object(d.a)((function(e){return e.breakpoints.up("sm")})),o=Object(d.a)((function(e){return e.breakpoints.up("md")}));return console.log(n,"This is my state"),r.a.createElement(pe.Provider,{value:{state:n,dispatch:l}},r.a.createElement(se.a,{only:"xs"},r.a.createElement(m,null)),r.a.createElement(me.a,{container:!0,spacing:3},r.a.createElement(me.a,{style:{paddingTop:i?80:10},item:!0,xs:12,md:7},r.a.createElement(ue,null),r.a.createElement(U,null)),r.a.createElement(me.a,{style:o?{position:"fixed",width:"100%",top:70,right:0}:{position:"fixed",width:"100%",left:0,bottom:0},item:!0,xs:12,md:5},r.a.createElement(k,null))))},be=a(236),he=a(237),fe=a(126),Ee=a(234),ve=a(235),ye=Object(fe.a)({palette:{type:"dark",primary:Ee.a,secondary:ve.a}}),Oe=a(127),xe=new _.ApolloClient({link:new Oe.a({uri:"wss://welcome-chipmunk-46.hasura.app/v1/graphql",options:{reconnect:!0}}),cache:new _.InMemoryCache});i.a.render(r.a.createElement(_.ApolloProvider,{client:xe},r.a.createElement(r.a.StrictMode,null,r.a.createElement(be.a,{theme:ye},r.a.createElement(he.a,null),r.a.createElement(ge,null)))),document.getElementById("root"))}},[[138,1,2]]]);
//# sourceMappingURL=main.973dacab.chunk.js.map